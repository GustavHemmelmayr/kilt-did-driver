# DID method specification

## Method

The identifier for KILT Protocol's DID Method is `kilt`.
A KILT DID starts with `did:kilt:`.

It conforms with the [generic DID syntax](https://w3c-ccg.github.io/did-spec/#generic-did-syntax).

## DID Method-specific identifier

The DID Method-specific identifier is an [ss58](https://github.com/paritytech/substrate/wiki/External-Address-Format-(SS58)) public address, generated by encoding the **signing** public key of a KILT Identity.

## Note

KILT DIDs are stored on the KILT Protocol blockchain that is public, permissionless and by definition decentralized.

In this specification, we'll refer to the [KILT SDK](https://github.com/KILTprotocol/sdk-js) as a convenient tool to interact with the KILT blockchain. However, there is no technical constraint to use the KILT SDK for any DID-related operation.

## Operation: Create a DID and DID Document

### Create a DID

For convenience, a KILT DID can be created with the `Did.fromIdentity` function made available in the [KILT SDK](https://github.com/KILTprotocol/sdk-js).
A storage location for the associated DID Document should be specified (`documentStore`).

An entry containing the following properties may then be encoded and stored on the KILT blockchain:

- `identifier`: the KILT DID identifier, e.g. `did:kilt:...`.
- `publicBoxKey`: the public encryption key for the KILT identity corresponding to this DID.
- `publicSigningKey`: the public signing key for the KILT identity corresponding to this DID.
- `documentStore`: the location where the DID Document is stored; usually a URL.

The storing transaction is signed.

Example of such a DID entry before encoding:

```javascript
{
  identifier: 'did:kilt:5CtPYoDuQQFLe1JU5F8KHLXkKaWxLkKH1dBAfHrUU8SoxASr',
  publicBoxKey:
   '0xfb151a959ed0e01fd9748105c617497f329339ed22207b9185cc40c48b44e004',
  publicSigningKey:
   '0x245e26168c3393e9c7fce042637b980758e783840974f9fadce4c8fe6fc76cb9',
  documentStore: 'https://services.kilt.io:443/contacts/5CtPYoDuQQFLe1JU5F8KHLXkKaWxLkKH1dBAfHrUU8SoxASr'
}
```

### Create the associated DID Document

The KILT SDK offers a function `getDefaultDocument` to create a default DID Document for a given DID.

Writing the DID Document onto the previously specified `documentStore` is not enforced in the KILT protocol nor in the KILT SDK.

This can be done via a third-party service. One such example of a DID Document creation service can be found in this [demo](https://demo.kilt.io/dashboard).

### Proving control

Proving control of a DID means proving the **binding** between this DID and the DID Document that describes it.
As mentioned in the [DID specification](https://w3c-ccg.github.io/did-spec/#proving-control-of-a-did-and-did-document), it is a two step process:

- Resolving the DID to a DID Document according to the KILT DID Method specification, as detailed below in "Operation: Read/Resolve";
- Verifying that the `id` property of the resulting DID Document matches the DID that was resolved.

## Operation: Read/Resolve a DID to a DID Document

In order to request a DID Document, its location must first be determined by querying the chain for the DID object, for example using `queryByIdentifier` (KILT SDK).
This returned DID object contains the `documentStore` as a property.
A standard HTTP/HTTPS fetch may be used to fetch `documentStore` and hence retrieve the associated DID Document. Other techniques might be used, depending on the storage location type.

## Operation: Update the DID Document

The DID Document can be updated on the DID storage location (`documentStore`). It must be ensured that the identity operating the update is authorized to do so, e.g. by making use of the "authentication" property in the DID Document.

## Operation: Deactivate

Deactivating a DID can be done the `remove` method on a DID (e.g. by using the KILT SDK's `Did.remove`).
This sets `documentStore` to `null`, effectively unlinking a DID from its DID Document.

## Security and Privacy considerations

An identity that creates a DID also effectively controls the associated DID Document.
Hence the private key for this identity should be kept entirely private.
